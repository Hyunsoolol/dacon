# 모델 개발 보고서

## 1. 프로젝트 개요 및 문제 접근법

### 1) 모델 설계 전략 및 접근법

- **문제 정의**
  - 운수종사자의 인지검사(A/B형) 결과와 과거 검사 이력을 활용하여  
    향후 **교통사고 위험도(사고 발생 확률)** 를 예측하는 이진 분류 모델 개발.
  - 대회 리더보드 평가는 AUC, Brier score, Expected Calibration Error(ECE)를 조합한 점수로 이루어지며,  
    단순 분류 성능뿐 아니라 **확률의 신뢰도(calibration)** 가 중요함.

- **전체 아키텍처 개요**
  - **전처리·피처엔지니어링 모듈**
    - `1_Preprocess_delta_logratio.py`
    - A/B형 검사 로그를 도메인 기반 요약 피처로 변환
    - PK(운수종사자) 수준 이력·변화(Delta)를 계산하고, 연령/시점 정규화 수행
  - **모델 학습 모듈**
    - `2_Train_Models_v18_delta_logratio.py`
    - CatBoost 기반 **A/B 이원(dual) 모델 구조**
    - K-Fold 교차검증 및 PK별 통계(PK Stats) 생성
    - Isotonic Regression을 통한 확률 보정 및 최종 모델 저장

- **모델 구조 선택 및 이유**
  - **CatBoostClassifier**
    - 범주형 변수(`Age`, `PrimaryKey`)를 직접 처리 가능
    - 결측치·비선형 관계에 강하고, 학습·튜닝이 안정적
    - 트리 기반 모델로 향후 SHAP 등을 통한 **설명 가능성** 확보 용이
  - **A/B 분리 모델**
    - A형과 B형의 과제 구성이 상이하고, 측정하는 인지 기능이 다르므로
      - **모델 A**: A형 전용 – Base + History + Normalization + log_ratio  
      - **모델 B**: B형 전용 – Base + PK Stats + History + Normalization + Delta(B-only) + log_ratio  
    - 각 검사 유형의 특성을 최대한 살리는 구조를 설계.

- **데이터 구조 및 검증 전략**
  - `PrimaryKey` 기준으로 반복 검사가 존재하는 **longitudinal 패널 데이터** 구조.
  - `StratifiedKFold(n_splits=5)`으로 Label 비율을 유지하며 교차검증 수행.
  - Fold별로 학습된 CatBoost + Isotonic 모델을 저장하고, 추론 시 **Fold 평균 앙상블**로 안정적 예측값 산출.

- **데이터 누출 방지 전략**
  - PK 통계(PK Stats)는 각 Fold의 Train 데이터에서만 집계 후  
    같은 Fold의 Train/Validation에만 사용해 데이터 누출을 차단.
  - B형 Delta 피처는 동일 PK의 직전 B 검사와의 차이만 사용하며, A형에서는 명시적으로 제거.
